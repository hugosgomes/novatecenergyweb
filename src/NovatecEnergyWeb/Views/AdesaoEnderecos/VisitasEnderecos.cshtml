@using NovatecEnergyWeb.Models.StoredProcedures;
@using Microsoft.AspNetCore.Http;
@using NovatecEnergyWeb.Core;
@model IEnumerable<_11_LoteAtivoEnderecos>
@{
    Layout = "~/Views/Shared/_LayoutSideNavBar.cshtml";
    ViewData["Title"] = "Status de Clientes Com Tratamento Comercial";
}

<div class="container">

    <!-- Modal -->
    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog  modal-sm">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Agenda Resultado Comercial</h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal" style="padding-left:15px;padding-right:15px;">

                        <h5 id="loteExibicao">Lote </h5>

                        <div class="control-group">
                            <label class="control-label labelsFormNav">Ano</label>
                            <div class="controls">

                                <select id="anos" style="width:80px;" class="alturaFormNavInput form-control fontTableBodyNavBar selectsNav" onchange="postFilters();">
                                    <option>2016</option>
                                    <option>2017</option>
                                </select>
                            </div>
                        </div>

                        <div class="control-group">
                            <label class="control-label labelsFormNav">Mês</label>
                            <div class="controls">
                                <select id="mes" class="alturaFormNavInput form-control fontTableBodyNavBar selectsNav" onchange="postFilters();">
                                    <option value="1">JANEIRO</option>
                                    <option value="2">FEVEREIRO</option>
                                    <option value="3">MARÇO</option>
                                    <option value="4">ABRIL</option>
                                    <option value="5">MAIO</option>
                                    <option value="6">JUNHO</option>
                                    <option value="7">JULHO</option>
                                    <option value="8">AGOSTO</option>
                                    <option value="9">SETEMBRO</option>
                                    <option value="10">OUTUBRO</option>
                                    <option value="11">NOVEMBRO</option>
                                    <option value="12">DEZEMBRO</option>
                                </select>
                            </div>
                        </div>
                        <br />
                        
                        <div class="control-group">
                            <div class="controls">
                                <a href="#" onclick="ExportaAgenda();">
                                    <img src="~/images/ms_excel.png" width="30" title="Exportar" height="30" />
                                </a>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
                </div>
            </div>

        </div>
    </div>

</div>

<div class="container-fluid">
    <div class="row">
        <div class="col-sm-3 col-lg-2">
            <nav class="navbar navbar-default navbar-fixed-side">
                <h4 id="titulo" class="text-center">Clientes de Lotes Ativos</h4>

                <table>
                    <tbody class="fontTableBodyNavBar">
                        <tr>
                            <td class="col-xs-9" style="padding-right:0px; ">Total de Endereços</td>
                            <td id="e0" class="col-xs-2 text-right">@Model.Count()</td>
                            <td class="col-xs-1 text-right"></td>
                        </tr>
                        <tr>
                            <td class="col-xs-9" style="padding-right:0px; ">Total Unidades (Potencial) </td>
                            <td id="e1" class="col-xs-2 text-right">@ViewBag.Potencial </td>
                            <td class="col-xs-1 text-right"></td>
                        </tr>
                        <tr>
                            <td class="col-sm-8">Unidades Visitadas</td>
                            <td id="e2" class="col-sm-2 text-right">@ViewBag.Visitados</td>
                            <td id="ep0" class="col-sm-2 text-right">@ViewBag.VisitadosPercent%</td>
                        </tr>
                        <tr class="espacoAbaixo">
                            <td class="col-xs-8" style="padding-right:0px;">Unidades Não Visitadas</td>
                            <td id="e3" class="col-xs-2 text-right">@ViewBag.NaoVisitados</td>
                            <td id="ep1" class="col-xs-2 text-right">@ViewBag.NaoVisitadosPercent%</td>
                        </tr>


                        <tr class="espacoAbaixo">
                            <td class="col-sm-8">Unidades Agendadas</td>
                            <td id="e4" class="col-sm-2 text-right">@ViewBag.VisitaAgendada</td>
                            <td id="ep2" class="col-sm-2 text-right">@ViewBag.VisitaAgendadaPercent%</td>
                        </tr>

                        <tr>
                            <td class="col-sm-8">Unidades Contratadas</td>
                            <td id="e5" class="col-sm-2 text-right">@ViewBag.Contratados</td>
                            <td id="ep3" class="col-sm-2 text-right">@ViewBag.ContratadosPercent%</td>
                        </tr>
                        <tr class="espacoAbaixo">
                            <td class="col-sm-8" style="padding-right:0px;">Unidades Não Contratadas</td>
                            <td id="e6" class="col-sm-2 text-right">@ViewBag.NaoContratados</td>
                            <td id="ep4" class="col-sm-2 text-right">@ViewBag.NaoContratadosPercent%</td>

                        </tr>

                        <tr>
                            <td class="col-sm-8">D2 Contratados</td>
                            <td id="e7" class="col-sm-2 text-right">@ViewBag.D2</td>
                            <td id="ep5" class="col-sm-2 text-right">@ViewBag.D2Percent%</td>
                        </tr>
                        <tr>
                            <td class="col-sm-8">SVG Contratados</td>
                            <td id="e8" class="col-sm-2 text-right">@ViewBag.Svg</td>
                            <td id="ep6" class="col-sm-2 text-right">@ViewBag.SvgPercent%</td>
                        </tr>
                        <tr class="espacoAbaixo">
                            <td class="col-sm-8">SVE Contratados</td>
                            <td id="e9" class="col-sm-2 text-right">@ViewBag.Sve</td>
                            <td id="ep7" class="col-sm-2 text-right">@ViewBag.SvePercent%</td>
                        </tr>

                        <tr class="espacoAbaixo">
                            <td class="col-xs-8" style="padding-right:0px;">Visitas Agendadas</td>
                            <td id="e10" class="col-sm-2 text-right">@ViewBag.NovaVisitaAgendada</td>
                            <td class="col-sm-2 text-right"></td>
                        </tr>

                        <tr>
                            <td class="col-sm-8">Visitas Realizadas</td>
                            <td id="e11" class="col-sm-2 text-right">@ViewBag.Visitas</td>
                            <td class="col-sm-2 text-right"></td>
                        </tr>
                        <tr>
                            <td class="col-sm-8">Entrevistas Realizadas</td>
                            <td id="e12" class="col-sm-2 text-right">@ViewBag.VisitasComResposta</td>
                            <td id="ep8" class="col-sm-2 text-right">@ViewBag.VisitasComRespostaPercent%</td>
                        </tr>
                        <tr>
                            <td class="col-sm-8">Visitas - Ausentes</td>
                            <td id="e13" class="col-sm-2 text-right">@ViewBag.Ausentes</td>
                            <td id="ep9" class="col-sm-2 text-right">@ViewBag.AusentesPercent%</td>
                        </tr>
                        <tr>
                            <td class="col-sm-8">Visitas - Endereços Inex.</td>
                            <td id="e14" class="col-sm-2 text-right">@ViewBag.Endinex</td>
                            <td id="ep10" class="col-sm-2 text-right">0%</td>
                        </tr>


                    </tbody>
                </table>

                <div class="buttonGroupNavBar">
                    <ul class="nav ">
                        <li id="todosli" class="fontTableBodyNavBar">
                            <a href="#" onclick="$(this).data('clicked', true); $('#titulo').html('Clientes de Lotes - Todos'); postToController();" id="todos">Todos os Lotes</a>
                        </li>
                        <li id="ativosli" class="disabled fontTableBodyNavBar">
                            <a href="#" id="ativos" onclick="$(this).data('clicked', true); $('#titulo').html('Clientes de Lotes Ativos'); postToController();">Lotes Ativos</a>
                        </li>
                   
                    </ul>
                </div>



                <form class="form-horizontal" style="padding-left:15px;padding-right:15px;">
                   



                    <div class="control-group">
                        <label class="control-label labelsFormNav">Zona</label>
                        <div class="controls">
                            @{
                                int? zona = Context.Session.GetInt32("Zona");

                                if (zona != null)
                                {
                                    <select id="zonas" onchange="postZona();  postToController();" disabled="disabled" class="alturaFormNavInput form-control fontTableBodyNavBar selectsNav">
                                        @for (int i = 0; i < ViewBag.Zonas.Count; i++)
                                        {
                                            if (zona == ViewBag.Zonas[i].Id)
                                            {
                                                ViewBag.ZonaSelecionada = i;
                                                <option value="@ViewBag.Zonas[i].Id">@ViewBag.Zonas[i].Zona</option>
                                            }
                                            else
                                            {
                                                <option value="@ViewBag.Zonas[i].Id">@ViewBag.Zonas[i].Zona</option>
                                            }
                                        }

                                    </select>
                                }
                                else
                                {
                                    <select id="zonas" onchange="postZona(); postToController();" class="alturaFormNavInput form-control fontTableBodyNavBar selectsNav">
                                        @foreach (var item in ViewBag.Zonas)
                                        {
                                            <option value="@item.Id">@item.Zona</option>
                                        }
                                    </select>
                                }
                            }
                        </div>
                    </div>


                    <div class="control-group">
                        <label class="control-label labelsFormNav">Delegação</label>
                        <div class="controls">
                            @{
                                int? delegacao = Context.Session.GetInt32("Delegação");

                                if (delegacao != null)
                                {
                                    <select id="delegacoes" onchange="postDelegacao(); postToController();" disabled="disabled" class="alturaFormNavInput form-control fontTableBodyNavBar delegacaoSelect">
                                        @for (int i = 0; i < ViewBag.Delegacao.Count; i++)
                                        {
                                            if (delegacao == ViewBag.Delegacao[i].Id)
                                            {
                                                ViewBag.DelegacaoSel = i;
                                            }
                                            <option value="@ViewBag.Delegacao[i].Id">@ViewBag.Delegacao[i].Delegacao</option>
                                        }
                                    </select>
                                }
                                else
                                {
                                    <select id="delegacoes" onchange="postDelegacao(); postToController();" class="alturaFormNavInput form-control fontTableBodyNavBar delegacaoSelect">
                                        @foreach (var item in ViewBag.Delegacao)
                                        {
                                            <option value="@item.Id">@item.Delegacao</option>
                                        }
                                    </select>
                                }
                            }
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label labelsFormNav">Área</label>
                        <div class="controls">

                            @{
                                int? area = Context.Session.GetInt32("Área");
                                int? areaQuantidade = Context.Session.GetInt32("QuantidadeArea");
                                if ((area != null) && (areaQuantidade != null && areaQuantidade == 1))
                                {
                                    <select id="areas" onchange="postArea(); postToController();" disabled="disabled" class="alturaFormNavInput form-control fontTableBodyNavBar" style="width:70px;">
                                        @for (int i = 0; i < ViewBag.Areas.Count; i++)
                                        {
                                            if (area == ViewBag.Areas[i].Id)
                                            {
                                                ViewBag.AreaSel = ViewBag.Areas[i].Id;
                                            }
                                            <option value="@ViewBag.Areas[i].Id">@ViewBag.Areas[i].Area</option>
                                        }
                                    </select>
                                }
                                else
                                {
                                    
                                        if ((areaQuantidade != null) && (areaQuantidade > 1))
                                        {
                                            ViewBag.areaQuantidade = areaQuantidade;

                                        }
                                    
                                    <select id="areas" onchange="postArea(); postToController();" class="alturaFormNavInput form-control fontTableBodyNavBar" style="width:70px;">
                                        @foreach (var item in ViewBag.Areas)
                                        {
                                            <option value="@item.Id">@item.Area</option>
                                        }
                                    </select>
                                }
                            }

                        </div>
                    </div>


                    <div class="control-group">
                        <label class="control-label labelsFormNav">Lote</label>
                        <div class="controls">
                            <select id="lotes" name="LoteError" onchange="postToController(); atribuiDataToggle();" class="alturaFormNavInput form-control fontTableBodyNavBar" style="width:100px;">

                                @foreach (var item in ViewBag.Lotes)
                                {
                                    <option value="@item[0]">
                                        @item[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                        @item[2]
                                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                        @item[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@item[4]
                                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@item[5]
                                    </option>
                                }

                            </select>
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label labelsFormNav">Endereço</label>
                        <div class="controls">
                            <input id="Endereco" class="alturaFormNavInput form-control fontTableBodyNavBar" type="text" />
                        </div>
                    </div>

                    
                  
                    <br />
                    <div class="col-xs-4"><a href="#" onclick="limpaFiltro();"><img src="~/images/filter_delete.png" title="Limpar Filtro" width="25" height="25" /></a></div>
                    <div class="col-xs-8"><a href="#" onclick="postToController();"><img src="~/images/binoculars_128.png" title="Filtrar" width="35" height="35" /></a></div>

                    <br />

                    <label class="fontTableBodyNavBar">Exportar Agenda Formato Gás Natural</label>

                    <a id="botaoExporta" href="#"  data-target="#myModal" onclick="entrarNaTelaExportacao();">
                        <img src="~/images/ms_excel.png" width="30" height="30" />
                    </a>
                </form>
            </nav>
        </div>

         <div class="col-sm-9 col-lg-10">
             <div id="page-selection"></div>
             <table id="tabelaEnderecoVisitas" class="table table-bordered table-striped tabelaModal">
                 <thead id="headTabelaLote">
                     <tr>
                         <th class="text-center">Z</th>
                         <th class="text-center">D</th>
                         <th class="text-center">AR</th>
                         <th class="text-center">Endereço</th>
                         <th class="text-center">Potencial</th>
                         <th class="text-center">Visitados</th>
                         <th class="text-center">Contratados</th>
                         <th class="text-center">UnidadesAgendadas</th>
                         <th class="text-center">VisitasAgendadas</th>
                         <th class="text-center">Visitas</th>
                         <th class="text-center">Entrevistas</th>
                         <th class="text-center">Ausências</th>
                         <th class="text-center">Endinex</th>
                         <th class="text-center">D2</th>
                         <th class="text-center">Svg</th>
                         <th class="text-center">Sve</th>
                    
                     </tr>
                 </thead>
                 <tbody id="corpoTabelaAtivos" class="corpoTabela">
                    
                 </tbody>
             </table>

         </div>
    </div>
</div>
@section Scripts{
<script type="text/javascript">
    $("#lotes").prop("selectedIndex", -1);
    $("#zonas").prop("selectedIndex", -1);
    $("#delegacoes").prop("selectedIndex", -1);
    $("#areas").prop("selectedIndex", -1);


    window.onload = function () {
        postToController();
        selecionaInfoCliente();
    };

    function getFormDataAsJson() {
        var botaoClicado = clicado();

        return {
            IdLote: $('#lotes').val(),
            ZId: $('#zonas').val(),
            DId: $('#delegacoes').val(),
            AId: $('#areas').val(),
            Endereco: $('#Endereco').val().toString().trim(),

            Botao: botaoClicado
        }
    }

    function postToController() {
        var data = getFormDataAsJson();
        $.post("@Url.Action("GetListLoteAtivoView", "AdesaoEnderecos")", data, atualizaView);
    }

    function clicado() {
        var id = '';
        if ($('#todos').data('clicked')) {
            $('#todos').data('clicked', false);
            id = 'todos';
            $('#todosli').addClass('disabled');
            $('#ativosli').removeClass('disabled');

        } else if ($('#ativos').data('clicked')) {
            $('#ativos').data('clicked', false);
            id = 'ativos';
            $('#todosli').removeClass('disabled')
            $('#ativosli').addClass('disabled');
        } else if (id == '') {
            if ($("#todosli").hasClass('disabled')) {
                id = 'todos';
            } else if ($("#ativosli").hasClass('disabled')) {
                id = 'ativos';
            }
        }

        return id;
    }

    function atualizaView(retorno) {
        tabelaEstatisticas(retorno);
        montaPaginacao(retorno);
        tabelaLoteAtivos(retorno);
    };

    function tabelaEstatisticas(retorno) {
        for (var i = 0; i < retorno.Numeracoes.length; i++) {
            $('#e' + i).html(retorno.Numeracoes[i]);
        }

        for (var j = 0; j < retorno.Porcentagens.length; j++) {
            $('#ep' + j).html(retorno.Porcentagens[j] + '%');
        }
    };

    function tabelaLoteAtivos(retorno) {
        $('#corpoTabelaAtivos tr').remove();

        var tr;
        var r = new Array();
        var j = -1;

        for (var i = 0; i < retorno.EV.length; i++) {

            r[++j] = "<tr>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].z;
            r[++j] = "</td>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].d;
            r[++j] = "</td>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].ar;
            r[++j] = "</td>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].endereco;
            r[++j] = "</td>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].potencial;
            r[++j] = "</td>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].visitados;
            r[++j] = "</td>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].contratados;
            r[++j] = "</td>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].unidadesAgendadas;
            r[++j] = "</td>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].visitasAgendadas;
            r[++j] = "</td>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].visitas;
            r[++j] = "</td>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].entrevistas;
            r[++j] = "</td>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].ausencias;
            r[++j] = "</td>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].endinex;
            r[++j] = "</td>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].d2;
            r[++j] = "</td>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].svg;
            r[++j] = "</td>";
            r[++j] = "<td>";
            r[++j] = retorno.EV[i].sve;
            r[++j] = "</tr>";
        }

        $('#corpoTabelaAtivos').html(r.join(''));
    }

    function postZona() {
        var p = {};
        p.zona = $("#zonas").val();
        $.post("@Url.Action("ZonaCascade", "AdesaoEnderecos")", p, atualizaDropZona);

    }

    function atualizaDropZona(retorno) {
        preencheDelegacao(retorno);
        preencheArea(retorno);
        preencheLotes(retorno);
    }

    function preencheZona(retorno) {
        $('#zonas').empty();

        $.each(retorno.Zonas, function () {
            $("#zonas").append($("<option />").val(this.id).text(this.zona));
        });

        $("#zonas").prop("selectedIndex", -1);
    }

    function preencheDelegacao(retorno) {
        $("#delegacoes").empty();

        $.each(retorno.Delegacao, function () {
            $("#delegacoes").append($("<option />").val(this.id).text(this.delegacao));
        });

        $("#delegacoes").prop("selectedIndex", -1);
    }

    function preencheArea(retorno) {
        if (retorno.Areas.length > 0) {
            $("#areas").empty();

            $.each(retorno.Areas, function () {
                $("#areas").append($("<option />").val(this.id).text(this.area));
            });

            $("#areas").prop("selectedIndex", -1);
        }
    }

    function preencheLotes(retorno) {
        if (retorno.Lotes.length > 0) {
            $("#lotes").empty();

            $.each(retorno.Lotes, function () {
                var p = $('<p>').html('&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;');

                $("#lotes").append($("<option />").val(this[0]).text(this[1] + p.text()
                      + this[2] + p.text()
                      + this[3] + p.text()
                      + this[4] + p.text() + this[5]));
            });

            $("#lotes").prop("selectedIndex", -1);
        }
    }

    function postDelegacao() {
        var p = {};
        p.delegacao = $("#delegacoes").val();
        $.post("@Url.Action("DelegacaoCascade", "AdesaoEnderecos")", p, atualizaDropsDelegacao);
    }

    function atualizaDropsDelegacao(retorno) {
        preencheArea(retorno);
        preencheLotes(retorno);
    }

    function postArea() {
        var p = {};
        p.lote = $("#areas").val();
        $.post("@Url.Action("AreaCascade", "AdesaoEnderecos")", p, atualizaDropArea);
    }

    function atualizaDropArea(retorno) {
        preencheLotes(retorno);
    }

    function limpaFiltro() {
        $('#zonas').val("");
        $('#delegacoes').val("");
        $('#areas').val("");
        $('#lotes').val("");
        $('#Endereco').val("");
        $('#botaoExporta').removeAttr('data-toggle');

        var parametro = {};
        parametro.Botao = clicado();
        parametro.LimpaFiltro = true;


        if ($("#todosli").hasClass('disabled')) {
            id = 'todos';
        } else if ($("#ativosli").hasClass('disabled')) {
            id = 'ativos';
        }

        if ((parametro.Botao == 'todos') || (parametro.Botao == 'ativos')) {
            $.post("@Url.Action("LimpaFiltros", "AdesaoEnderecos")", parametro, bindSelects);

        }

    }

    function bindSelects(retorno) {
        atualizaView(retorno);
        parametro = {};

        $.post("@Url.Action("LimpaSelects", "AdesaoEnderecos")", parametro, atualizaSelects);
    }

    function atualizaSelects(retorno) {
        preencheZona(retorno);
        preencheDelegacao(retorno);
        preencheArea(retorno);
        preencheLotes(retorno);
        selecionaInfoCliente();
    }

    function montaPaginacao(retorno) {
        //paginação
        $('#page-selection').unbind(); // limpa os eventos adicionados nessa tag

        $('#page-selection').bootpag({
            total: retorno.QuantasPaginasExistem,
            page: 1,
            maxVisible: 5,
            firstLastUse: true,
            first: '←',
            last: '→',
            nextClass: 'next',
            prevClass: 'prev',
            lastClass: 'last',
            firstClass: 'first'

        }).on("page", function (event, num) {
            // some ajax content loading...
            postPaginacao(num);

        });

    }

    function postPaginacao(num) {
        var data = getFormDataAsJson();
        data.PaginaClicada = num;
        $.post("@Url.Action("GetListLoteAtivoView", "AdesaoEnderecos")", data, tabelaLoteAtivos);
    }

    function entrarNaTelaExportacao() {
        $("#mes").val("@DateTime.Now.Month");
        $("#anos").val("@DateTime.Now.Year");

        if ($("#lotes").val() != null) {
            var lt = $("#lotes :selected").text().toString();
            var ltf = lt.split(" ").join("").substr(0, 5).toString();
            document.getElementById("loteExibicao").innerHTML = 'Lote ' + ltf;
        } else {
            alert('Selecione um lote');
        }
        postFilters();
    }

    function postFilters() {
        var data = {
            Ano: $("#anos").val(),
            Mes: $("#mes").val()
        };

        $.post("@Url.Action("SetFiltrosTelaExportacao", "AdesaoEnderecos")", data);
    }
    function ExportaAgenda() {

        var url = '@AppSettings.ExcelExportUrl';
        window.location.href = '' + url + '/AdesaoEnderecos/ExportaAgendaAdesao?';
    }

    //usado na combo de lote para acrescentar o atributo data-toggle pra abrir a telinha de exportação
    function atribuiDataToggle() {
        var vatt = $('#botaoExporta').attr('data-toggle');
        if (vatt == null) {
            $('#botaoExporta').attr('data-toggle', 'modal');
        }
    }

    //Parte de exibição "travada" das informações do cliente(zona, delegação, área e lote)
    //----------------------------
    function selecionaInfoCliente() {
       
        var zs = '';
        var ds = '';

        if ('@ViewBag.ZonaSelecionada' != '') {
            zs = '@ViewBag.ZonaSelecionada';
            $("#zonas").prop("selectedIndex", zs);
        }

        if ('@ViewBag.DelegacaoSel' != '') {
            ds = '@ViewBag.DelegacaoSel';
            $("#delegacoes").prop("selectedIndex", ds);
           // postDelegacao();
        }
        selecionaAreaCliente();

    }

    function selecionaAreaCliente() {
        var data = {};
        $.post("@Url.Action("AreasDoCliente", "AdesaoEnderecos")", data, atualizaDropsDelegacao);
        
    }

</script>
}